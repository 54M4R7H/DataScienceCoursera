{
    "collab_server" : "",
    "contents" : "# ============================================================================================================\n# Description:   Course Project Week 5 / Behavioral Risk Factor Surveillance System\n#                Coursera Statistics at Duke University\n#\n#\n# Dataset:       brfss2013 [53Mb](https://d3c33hcgiwev3.cloudfront.net/_384b2d9eda4b29131fb681b243a7767d_brfss2013.RData?Expires=1464220800&Signature=QjjfkYt-C-wTRcwEvnuyFDvphasfoKEAkMo-088OscAJxIV7NbLUqOmkJZBXsVLUuJmJZmatWsi7bOoG9WMkp18BK4bGVvEpAjHyar9fOMmT9TcnFax5m2Dj8nJZzqox4IV20XOtnijNbzwQH4N8yd7CtbIc1tNTgeo8mq5ezjQ_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A)\n# Information:   Download Link: [http://www.cdc.gov/brfss/annual_data/annual_2013.html]    \n#\n# Author:        Bruno Hunkeler\n# Date:          24.05.2016\n#\n# ============================================================================================================\n\n# ============================================================================================================\n# Load Libraries\n# ============================================================================================================\n\nlibrary('dplyr')\nlibrary('ggplot2')\nlibrary('plyr')\nlibrary('gridExtra')\nlibrary('ggmap')\n\nloadFunctions <- FALSE\nUSPopulation2016 <- 323663800\n\n# ============================================================================================================\n# Download and extract Data and load file\n# ============================================================================================================\n\n# load the data set \nload(file = 'Data/brfss2013.RData')\ndata <- brfss2013\n\n# evaluate the size of the data set\n# dim(data)\n# str(data)\n# summary(data)\n\n# retrieve only the required columns \nCol <- c('X_state', 'sex', 'genhlth', 'hlthpln1', 'income2', 'X_incomg', 'educa', 'X_educag', 'X_frutsum', 'X_vegesum', 'X_bmi5', 'X_bmi5cat', 'exerany2')\ndata.req <- data[, Col]\n\n# ====================================================================================================\n# Research questions\n# ====================================================================================================\n\n# Overall assumtion should be verified \n# - BMI analysis overall US population \n# \n# 1) Has the availability of health care plan an implication on the general health of people. \n# 2) Is there a qualitative relation between general health and the income resp. the education\n# 3) Is there a relation between general health and BMI\n# 4) Does weekly exercise support the general health of people. \n#    What are the implications of fruit / alcohol consumption on peoples general health. Is there a relation between general health \n#    and nutrition / alcohol consumption \n\n# ====================================================================================================\n# Research question 0\n# ====================================================================================================\n\n# evaluate the percentage of the US population based on bmi Category\n\nbmi.cat <- count(data.req, 'X_bmi5cat')\nbmi.cat <- bmi.cat[-5,]\nbmi.cat$percent <- prop.table(bmi.cat$freq)\nbmi.cat$population <- lapply(bmi.cat$percent, function(x) {\n    USPopulation2016 * x\n})\n\n# BMI Category    | Percentage of US Population | Population   | \n# - - - - - - - - | - - - - - - - - - - - - - - | - - - -  - - | \n# UNderweight     |                      1.77%  |     5753661  | \n# Normal weight   |                     33.30%  |   107805808  | \n# Overweight      |                     35.92%  |   116287012  | \n# Obese           |                     28.98%  |    93817319  | \n\nggplot(bmi.cat, aes(x = factor(X_bmi5cat), y = percent, fill = percent, alpha = 0.8)) +\n geom_bar(stat = 'identity') +\n xlab('BMI Category') + ylab('Percentage of US Population') +\n ggtitle('Distribution of US Population (BMI Category)') +\n theme(axis.text.x = element_text(angle = 90, hjust = 1)) + \ngeom_text(aes(label = X_bmi5cat), vjust = 1.6, color = 'black', position = position_dodge(0.9), size = 3)\n\npar(mfrow = c(2, 2))\n\n# is there a relation between healt care and general condition \nmosaicplot( ~ genhlth + hlthpln1, data = data.req, xlab = 'General health', ylab = 'Health plan', color = c('lightblue', 'steelblue'), main = 'General Health vs Helth care plan')\n\n# is there a relation between exercise and general condition \nmosaicplot( ~ genhlth + exerany2, data = data.req, xlab = 'General health', ylab = 'Excercise', color = c('lightblue', 'steelblue'), main = 'General Health vs Excercise')\n\n# clean up unused variables \nrm(bmi.cat)\nrm(bmi.category)\nrm(data.req)\n\nif (loadFunctions == TRUE) {\n    # Load initial functions to convert data \n    conv.ft.m <- function(x) ifelse(x > 9000, ((x - 9000) / 100), ((x / 100) * 0.3048))\n    conv.pnd.kg <- function(x) ifelse(x > 9000, (x - 9000), (x * 0.453592))\n\n    # Body Mass Index = weight in kg / (height in m2)\n    calc.BMI = function(x, y) {\n        return(BMI = x / y ^ 2)\n    }\n}\n\n# ====================================================================================================\n# Research question 0.1 \n# \n# ====================================================================================================\n\nCol <- c('X_state', 'X_bmi5', 'X_bmi5cat')\ndata.rsq0 <- data[, Col]\n\nsurvey.population.State <- count(data.rsq0, 'X_state')\nsurvey.population.State <- survey.population.State[-1,]\nsurvey.population.State <- survey.population.State[-54,]\n\nfilterObese <- data.rsq0 %>% filter(X_bmi5cat == 'Obese') %>% group_by(X_state)\nobese.population.State <- count(filterObese, 'X_state')\n\ncolnames(ObeseState) <- c('X_state','Obese')\nobese.population.State$sample <- survey.population.State$freq\n\n\n\n\n<- bmi.cat[-5,]\nbmi.cat$percent <- prop.table(bmi.cat$freq)\nbmi.cat$population <- lapply(bmi.cat$percent, function(x) {\n    USPopulation2016 * x\n})\n\n\n\n# ====================================================================================================\n# Research question 1 \n# Is there a relation between Pysical healt, Income, Health care and education \n# ====================================================================================================\n\nCol <- c('X_state', 'sex', 'genhlth', 'hlthpln1', 'X_frutsum', 'X_vegesum', 'X_bmi5', 'X_bmi5cat',  'X_frtlt1', 'X_veglt1', 'X_pacat1', 'exract11', 'X_age80')\ndata.rsq1 <- data[, Col]\n\n# create summary for used features\n# summary(data$hlthpln1)\n# summary(data$income2)\n# summary(data$educa)\n\n# remove all rows with 'NA'\ndata.rsq1 <- data.rsq1[complete.cases(data.rsq1),]\n\ndata.rsq1 <- data.rsq1 %>% mutate(X_frtlt1 = ifelse(X_frtlt1 %in% c(\"Consumed fruit one or more times per day\"), 1, 0))\ndata.rsq1 <- data.rsq1 %>% mutate(X_veglt1 = ifelse(X_veglt1 %in% c(\"Consumed vegetables one or more times per day\"), 1, 0))\n\n\nplot(data.rsq1$X_age80, data.rsq1$X_bmi5)\n\nggplot(data = data.rsq1, aes(x = X_age80, y = X_bmi5)) + geom_point(col = 'blue') + geom_smooth(method = lm)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nds1 <- data.rsq1 %>% group_by(X_incomg) %>% filter(genhlth == 'Excellent')\nds <- ddply(data.rsq1, .(X_incomg, genhlth), summarise, count = table(genhlth))\n\na <- subset(ds, count > 0)\n# co <- c('red', 'green', 'blue', 'yellow', 'steelblue', 'purple')\n# ggplot(a, aes(x = genhlth, y = count)) + geom_bar()\n# ggplot(a, aes(x = genhlth, y = count, fill = X_incomg, col = X_incomg)) + geom_point(pch = 19, size = 5) + facet_grid(genhlth ~ .)\nggplot(a, aes(x = genhlth, y = count, fill = X_incomg, col = X_incomg)) + geom_point(pch = 19, size = 5) +\ngeom_line(aes(group = 1), colour = \"#000099\") # Blue lines\n\n# ====================================================================================================\n# Research question 2\n# Is there a relation between Pysical healt, Excercise and BMI\n# ====================================================================================================\nCol <- c('X_state', 'sex', 'genhlth', 'hlthpln1', 'income2', 'educa', 'X_incomg', 'educa', 'X_educag', 'X_frutsum', 'X_vegesum', 'X_bmi5', 'X_bmi5cat', 'exerany2', \"X_frtlt1\", \"X_veglt1\", \"X_frt16\" \"X_veg23\")\nCol <- c('X_state', 'sex', 'genhlth', 'X_bmi5', 'htm4', 'wtkg3', 'exerany2')\ndata.rsq2 <- data[, Col]\n\ndim(data.rsq2)\n\ndata.rsq2 <- data.rsq2[complete.cases(data.rsq2),]\nsummary(data.rsq2)\n\nhist(data.rsq2$X_bmi5, 50, col = 'steelblue')\n\ndata.rsq2 <- mutate(data.rsq2, X_bmi5 = round((X_bmi5 / 100), 2))\ndata.rsq2 <- mutate(data.rsq2, htm4 = round((htm4 / 100), 2))\ndata.rsq2 <- mutate(data.rsq2, wtkg3 = round((wtkg3 / 100), 2))\n\ndata.rsq2 <- data.rsq2 %>% filter(htm4 < 2.5)\n\nggplot(data.rsq2, aes(x = htm4, y = X_bmi5)) +\n    geom_point(col = 'blue') +\n    ylab('X_BMI') + xlab(\"Height\") +\n    ggtitle(\"Number of Steps per Interval (weekend/weekend\") +\n    facet_grid(genhlth ~ .)\n\n\n\ndd <- data.rsq2 %>% group_by(genhlth) %>% filter(genhlth == 'Excellent') %>% summarise(mean_g = mean(genhlth), sd_dd = sd(genhlth), n = n())\n\n\n# ====================================================================================================\n# Research question 2\n# Is there a relation between Pysical healt, Excercise and BMI\n# ====================================================================================================\n\nCol <- c('X_state', 'sex', 'genhlth', 'weight2', 'height3', 'exerany2')\ndata.rsq2 <- data[, Col]\n\n\n# remove all rows with 'NA' and blank data\ndata.rsq2 <- data.rsq2[complete.cases(data.rsq2),]\ndata.rsq2 <- data.rsq2[ - which(data.rsq2$weight2 == ''),]\n\n# remove row with special character \ndata.rsq2 <- data.rsq2[ - which(data.rsq2$weight2 == '.b'),]\n\ndata.rsq2$weight2 <- as.numeric(as.character(data.rsq2$weight2))\n\n# clean <- c(15688, 73709)\n# data.rsq2[73709, 'weight2'] <- data.rsq2[73709, 'weight2'] - 9000\n# data.rsq2[15688, 'weight2'] <- data.rsq2[15688, 'weight2'] - 9000\n\n\n# Convert pounds to kg and ft to meters \ndata.rsq2 <- mutate(data.rsq2, weight2 = round(conv.pnd.kg(weight2), 2))\ndata.rsq2 <- mutate(data.rsq2, height3 = round(conv.ft.m(height3), 2))\n\n#remove obvisually wrong data\ndata.rsq2 <- data.rsq2[ - which(data.rsq2$height3 > 2.5),]\ndata.rsq2 <- data.rsq2[ - which(data.rsq2$weight2 > 250),]\n\nggplot(data = data.rsq2, aes(x = weight2), col = 'steelblue') + geom_histogram()\n\n\nrdu_flights %>%\n  summarise(mean_dd = mean(dep_delay), sd_dd = sd(dep_delay), n = n())\n\na <- data.rsq2 %>% filter(weight2 < 9000)\nhist(a$weight2, breaks = 50, col = 'steelblue', xlab = 'weight', ylab = 'number', main = 'weight distribution')\nhist(log10(a$weight2), breaks = 50, col = 'steelblue', xlab = 'weight', ylab = 'number', main = 'weight distribution')\n\nb <- data.rsq2 %>% filter(height3 < 7000)\nhist(b$height3, breaks = 50, col = 'steelblue', xlab = 'height3', ylab = 'number', main = 'weight distribution')\nhist(log10(b$height3), breaks = 50, col = 'steelblue', xlab = 'height3', ylab = 'number', main = 'weight distribution')\n\n\nggplot(data.rsq2, aes(weight2, height3)) + geom_point()\nggplot(data.rsq2, aes(x = height3, y = weight2)) + geom_point()\n\n# calculate the BMI \ndata.rsq2 <- mutate(data.rsq2, BMI = round(calc.BMI(weight2, height3), 2))\n\nc <- which(data.rsq2$X_state == 'Louisiana' & data.rsq2$height3 == 504 & data.rsq2$genhlth == 'Poor' & data.rsq2$sex == 'Female')\na <- data.rsq2[c,]\n\n\nhist(data.rsq2$weight2, breaks = 100, col = 'blue')\nhist(data.rsq2$height3, breaks = 500, col = 'green')\nhist(data.rsq2$BMI, breaks = 100, col = 'blue')\n\n# calc BMI /  Excercise \n# summary(data$weight2)\n# summary(data$height3)\n# summary(data$exerany2)\n\n# handle NA values\n# reasign unknown to feature which are \"Not Available\", \"NULL\", \"Not Mapped\"\n# test <- test %>% mutate(weight2 = ifelse(weight2 %in% c(\"\", \"9999\"), \"NA\", weight2))\n# mutate(test, weight2 = ifelse(weight2 == '', 'NA', weight2))\n\ntest <- data.rsq2\n\ntest.NoNA <- test[complete.cases(test),]\ntest.NoNA <- test.NoNA[ - which(test.NoNA$weight2 == ''),]\ntest.NoNA$weight2 <- as.numeric(as.character(test.NoNA$weight2))\ntest.NoNA <- mutate(test.NoNA, weight2 = round(conv.pnd.kg(weight2), 2))\ntest.NoNA <- mutate(test.NoNA, height3 = round(conv.ft.m(height3), 2))\n\ntest.NoNA <- mutate(test.NoNA, BMI = round(calc.BMI(weight2, height3), 2))\n\ntest.NoNA$weight2 <- lapply(test.NoNA$weight2, conv.pnd.kg)\n\n# based on variable values\ndata.rsq2 <- data.rsq2[which((data.rsq2$height3 > 100) & (data.rsq2$height3 < 8000)),]\ndata.rsq2 <- data.rsq2 %>% filter((height3 > 100) & (height3 < 8000))\n\nrdu_flights %>%\n  group_by(origin) %>%\n  summarise(mean_dd = mean(dep_delay), sd_dd = sd(dep_delay), n = n())\n\n\n\n# ====================================================================================================\n# Research question 3\n# Is there a relation between Pysical healt, education and nutrition\nCol <- c('X_state', 'sex', 'genhlth', 'educa', 'fruit1', 'vegetab1')\ndata.rsq3 <- data[, Col]\n\n# fruit & vegi consumtion\nsummary(data$vegetab1)\nsummary(data$fruit1)\n\n\n\n\n# remove all rows with 'NA'\ndata.rsq3.NoNA <- data.rsq1[complete.cases(data.rsq3),]\n\n\n\n\n\n\n# remove all rows with 'NA'\ndata.NoNA <- dd[complete.cases(dd),]\n\n\ndd_male <- nrow(dd %>% filter(sex == \"Male\"))\ndd_female <- nrow(dd %>% filter(sex == \"Female\"))\n\nnoMale <- nrow(dd$sex == 'Male', na.rm = TRUE)\nnoFeMale <- sum(dd$sex == 'female')\n\nhist(as.numeric(as.factor(dd$sex)))\n\n\n\n\n",
    "created" : 1464671643903.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3730158041",
    "id" : "C9B22ABB",
    "lastKnownWriteTime" : 1464803094,
    "last_content_update" : 1464803094,
    "path" : "C:/Users/bruno.hunkeler/OneDrive/Dokumente/Coursera_Courses/Statistics - Duke University/001_Introduction_to_Probability_and_Data/Week 5/Lab/Project5/bfrss_analysis.R",
    "project_path" : "bfrss_analysis.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}